<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>
        <record id="menu_shop" model="website.menu">
            <field name="name">Properties</field>
            <field name="parent_id" ref="website.main_menu"/>
            <field name="url">estate/home</field>
        </record>
    </data>
    <template id="property">
        <t t-call="website.layout">
            <t t-set="title">Properties</t>
            <div class="oe_structure" />
            <div class="oe_structure">
                <div class="container">
                    <h3 t-field="properties.name" class="text-center mt-3" />
                    <p class="text-end">Last modified: <i t-field="properties.write_date" t-options='{"widget":"relative"}'/></p>
                        <div>
                            About <span t-field="properties.name" />: <span t-field="properties.description"></span>
                            <div>
                                Property Type: <span t-field="properties.property_type_id"></span>
                            </div>
                            <div>
                                Postcode: <span t-field="properties.postcode"></span>
                            </div>
                            <div>
                                Date Availability: <span t-field="properties.date_availability"></span>
                            </div>
                            <div>
                                Expected Price: <span t-field="properties.expected_price"></span>
                            </div>
                            <div>
                                Bedrooms: <span t-field="properties.bedrooms"></span>
                            </div>
                            <div>
                                Living Area: <span t-field="properties.living_area"></span>
                            </div>
                            <div>
                                Sales Person: <span t-field="properties.salesperson_id"></span>
                            </div>
                            <div>
                                Best Offer: <span t-field="properties.best_offer"></span>
                            </div>
                        </div>
                    <t t-if="properties.offer_ids">
                        <h3 class="text-center mt-3 text-decoration-underline">Offers</h3>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Price</th>
                                    <th>Partner</th>
                                    <th>Validity (days)</th>
                                    <th>Deadline</th>
                                    <th>State</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="offers" t-value="properties.mapped('offer_ids')"/>
                                <tr t-foreach="offers" t-as="offer">
                                    <td>
                                        <span t-field="offer.price" />
                                    </td>
                                    <td>
                                        <span t-field="offer.partner_id" />
                                    </td>
                                    <td>
                                        <span t-field="offer.validity" />
                                    </td>
                                    <td>
                                        <span t-field="offer.date_deadline" />
                                    </td>
                                    <td>
                                        <span t-field="offer.status" />
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </t>
                    <t t-else="">
                        <div class="mt-3 text-center">No offers have been made yet :(</div>
                    </t>
                    <div class="mb-5"></div>
                </div>
            </div>
            <div class="oe_structure" />
        </t>
    </template>
    <template id="index">
        <t t-call="website.layout">
            <t t-set="title">Properties</t>
            <h1 class="text-center mt-3">Properties</h1>
            <div class="oe_structure">
                <div class="container">
                    <ul>
                        <t t-foreach="properties" t-as="property">
                            <li>
                                <a t-attf-href="/estate/{{slug(property)}}">
                                    <t t-esc="property.name" />
                                </a>
                            </li>
                        </t>
                    </ul>
                </div>
            </div>
        </t>
    </template>

</odoo>
